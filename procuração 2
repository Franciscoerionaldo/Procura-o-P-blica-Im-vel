import PyPDF2
import re

# Função para extrair texto do PDF
def extrair_texto_pdf(pdf_file):
    with open(pdf_file, 'rb') as f:
        reader = PyPDF2.PdfReader(f)
        texto_pdf = ""
        for page in reader.pages:
            texto_pdf += page.extract_text() or ''
    return texto_pdf

# Função para extrair campo usando regex
def extrair_campo(padrao, texto, padrao_nao_encontrado='NÃO ENCONTRADO'):
    resultado = re.search(padrao, texto, re.IGNORECASE)
    return resultado.group(1).strip() if resultado else padrao_nao_encontrado

# Mapeamento de campos e seus padrões regex
campos = {
    "nome_outorgante": r'Nome completo: (.+)',
    "nacionalidade_outorgante": r'Nacionalidade: (.+)',
    "nascimento_outorgante": r'Data de nascimento: (.+)',
    "estado_civil_outorgante": r'Estado civil: (.+)',
    "regime_bens_outorgante": r'Regime de bens: (.+)',
    "profissao_outorgante": r'Profissão: (.+)',
    "nome_pai_outorgante": r'Filho de (.+) e',
    "nome_mae_outorgante": r'e de (.+), portador',
    "identidade_outorgante": r'identificação nº ([\d\w.-]+)',
    "orgao_exp_outorgante": r'órgão expedidor (.+?),',
    "uf_orgao_exp_outorgante": r'UF órgão expedidor (.+?),',
    "data_emissao_outorgante": r'data da emissão (.+?),',
    "cpf_outorgante": r'CPF/MF nº ([\d\.-]+)',
    "endereco_outorgante": r'residente e domiciliado à (.+?), nº',
    "numero_end_outorgante": r'nº\. (.+?), bairro',
    "bairro_outorgante": r'bairro (.+?), cidade',
    "cidade_outorgante": r'cidade (.+?), endereço',
    "email_outorgante": r'endereço eletrônico (.+?)\.',
    # Adicione campos do procurador ou outros conforme necessidade
}

# Extrai o texto do PDF
pdf_file = 'SEU_ARQUIVO.pdf'  # Coloque o nome do PDF aqui
texto_pdf = extrair_texto_pdf(pdf_file)

# Extrai todos os campos
valores = {}
for campo, padrao in campos.items():
    valores[campo] = extrair_campo(padrao, texto_pdf)

# Modelo com marcadores únicos para facilitar a substituição
modelo = '''
Nome completo: <<nome_outorgante>>, nacionalidade <<nacionalidade_outorgante>>, data de nascimento <<nascimento_outorgante>>, declarou ser estado civil <<estado_civil_outorgante>>, sob o regime <<regime_bens_outorgante>>, profissão <<profissao_outorgante>>, filho de <<nome_pai_outorgante>> e de <<nome_mae_outorgante>>, portador do documento de identificação nº <<identidade_outorgante>>, órgão expedidor <<orgao_exp_outorgante>>, UF órgão expedidor <<uf_orgao_exp_outorgante>>, data da emissão <<data_emissao_outorgante>>, inscrito no CPF/MF nº <<cpf_outorgante>>, residente e domiciliado à <<endereco_outorgante>>, nº. <<numero_end_outorgante>>, bairro <<bairro_outorgante>>, cidade <<cidade_outorgante>>, endereço eletrônico <<email_outorgante>>.
'''

# Substitui todos os marcadores pelos valores extraídos
for campo, valor in valores.items():
    modelo = modelo.replace(f'<<{campo}>>', valor)

print(modelo)
